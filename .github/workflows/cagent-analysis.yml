name: AI Code Review
on:
  pull_request:
    types: [opened]

jobs:
  review:
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write

    steps:
      - uses: actions/checkout@v4

      - name: Security Review
        uses: docker/cagent-action@latest
        with:
          agent: docker/github-action-security-scanner
          prompt: "Analyze for security issues"
          openai-api-key: ${{ secrets.OPENAI_API_KEY }}

      - name: Code Quality Analysis
        uses: docker/cagent-action@latest
        with:
          agent: docker/code-quality-analyzer
          prompt: "Analyze code quality and best practices"
          openai-api-key: ${{ secrets.OPENAI_API_KEY }}